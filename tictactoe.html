<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Tic Tac Toe</title>
        <link rel="stylesheet" href="all.css">
        <link rel="stylesheet" href="tictactoe.css">
    </head>

    <body>
        <div class="header">
            <div class="header-left"><a href="index.html"><img style="height: auto; width: 35px" src="assets/tetrisCatIcon.png"/></a></div>
            <div class="header-center">
                <a href="index.html">Home</a>
                <a href="help.html">Help</a>
                <a href="store.html">Store</a>
            </div>
            <div class="header-right">
                <a href="#" class="signup-btn">Sign up</a>
                <a href="#" class="login-btn">Login</a>
            </div>
        </div>

        <div class="scroll-container">
            <div class="scroll-progress-bar" id="scrollBar"></div>
        </div>

        <h1>Tic Tac Toe</h1>
        <div class="board" id="board"></div>
        <button class="button" onclick="resetGame()">Reset Board</button>

        <div class="overlay" id="TTToverlay" onclick="closePopup()"></div>
        <div class="container" id="TTTpopupBox">
            <img class="popup-tetriscat" style="rotate: 0deg; height: 150px; width: auto; left: 285px; top: -148px;" src="assets/tetrisCat3.GIF" alt=""/>
            <div class="contact-box">
                <div class="sos-box">SOS!!</div>
                <button class="close-btn" onclick="closePopup()">Ã—</button>
                <p id="popup-text"><strong>Click to start!</strong></p>
            </div>
        </div>

<!--        <div class="footer">-->
<!--            &copy; 2025 OMG Platform | Created by dreamers, for players. | Contact us at contact@omgame.club-->
<!--        </div>-->

        <script>
            const winPatterns = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8],
                [0, 3, 6], [1, 4, 7], [2, 5, 8],
                [0, 4, 8], [2, 4, 6]
            ];
            const cellPositions = [
                "top-left", "top-middle", "top-right",
                "middle-left", "middle", "middle-right",
                "bottom-left", "bottom-middle", "bottom-right"
            ];
            let currentWinPattern = [];
            let moveCount = 0;

            function resetGame() {
                moveCount = 0;
                currentWinPattern = winPatterns[Math.floor(Math.random() * winPatterns.length)];
                document.getElementById("board").innerHTML = "";
                for (let i = 0; i < 9; i++) {
                    const cell = document.createElement("div");
                    cell.classList.add("cell", "disabled");
                    cell.id = `cell-${i}`;
                    cell.onclick = () => makeMove(i);
                    document.getElementById("board").appendChild(cell);
                }
                showPopup(`<strong>Hi! Welcome to TicTacToe instructions!</strong><br><br>I'm Tetris Cat and I will be teaching you how to play!<br><br>Click the ${cellPositions[currentWinPattern[0]]} square to begin!`);
                enableCell(currentWinPattern[0]);
            }

            function enableCell(index) {
                document.getElementById(`cell-${index}`).classList.remove("disabled");
            }

            function makeMove(index) {
                const cell = document.getElementById(`cell-${index}`);
                if (cell.classList.contains("disabled")) return;

                cell.innerHTML = "<span>X</span>";
                cell.classList.add("disabled");
                moveCount++;

                if (moveCount < currentWinPattern.length) {
                    const nextMove = currentWinPattern[moveCount];
                    showPopup(`Nice! Now click the ${cellPositions[nextMove]} square.`);
                    enableCell(nextMove);
                    setTimeout(() => computerMove(), 500);
                } else {
                    showPopup("You won! Click reset to play again.");
                }
            }

            function computerMove() {
                let availableCells = Array.from(document.querySelectorAll('.cell:not(.disabled)'));
                let safeCells = availableCells.filter(cell => {
                    let cellIndex = parseInt(cell.id.replace('cell-', ''));
                    return !currentWinPattern.includes(cellIndex);
                });

                if (safeCells.length > 0) {
                    let randomCell = safeCells[Math.floor(Math.random() * safeCells.length)];
                    randomCell.innerHTML = "<span>O</span>";
                    randomCell.classList.add("disabled");
                }
            }

            function showPopup(text) {
                document.getElementById("popup-text").innerHTML = text;
                document.getElementById("TTTpopupBox").classList.add("show");
                document.getElementById("TTToverlay").classList.add("show");
            }

            function closePopup() {
                document.getElementById("TTTpopupBox").classList.remove("show");
                document.getElementById("TTToverlay").classList.remove("show");
            }

            resetGame();
        </script>
    </body>
</html>
